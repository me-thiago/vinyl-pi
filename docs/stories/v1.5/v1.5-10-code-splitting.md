# Story V1.5-10: Code Splitting + Layout Persistente com Player

**Epic:** V1.5 - Hardening & Quality (Post-Audit)

**Status:** done

**Prioridade:** ğŸŸ¢ MÃ©dio

**Origem:** RelatÃ³rio de Auditoria 2025-12-03 - SeÃ§Ã£o 8: Performance (8/10) + Feedback do usuÃ¡rio

**User Story:**
Como usuÃ¡rio,
quero que a interface carregue rapidamente e que o player continue tocando ao navegar entre pÃ¡ginas,
para ter uma experiÃªncia fluida e contÃ­nua estilo Spotify.

## Contexto do Problema

O bundle do frontend nÃ£o estÃ¡ otimizado:

```
# Auditoria identificou:
- Bundle frontend nÃ£o otimizado para produÃ§Ã£o (195KB)
- Sem lazy loading de rotas no frontend
- Sem cache headers para assets estÃ¡ticos
```

AlÃ©m disso, ao trocar de pÃ¡gina o Player Ã© destruÃ­do e o Ã¡udio para, prejudicando a experiÃªncia.

## CritÃ©rios de AceitaÃ§Ã£o

### Code Splitting & Performance
1. [ ] Rotas secundÃ¡rias implementadas com lazy loading (React.lazy)
2. [ ] Code splitting por rota configurado no Vite
3. [ ] Vendor chunks separados (react, recharts, socket.io)
4. [ ] Bundle inicial < 100KB (gzipped)
5. [ ] Loading states para chunks sendo carregados
6. [ ] Cache headers configurados no Express para assets

### Layout Persistente & Player
7. [ ] Layout compartilhado com Header e PlayerBar fixos
8. [ ] Player continua tocando ao navegar entre pÃ¡ginas
9. [ ] PÃ¡gina inicial minimalista focada no VinylVisualizer
10. [ ] PlayerBar compacta na parte inferior com todos os controles
11. [ ] VU Meter em tempo real na PlayerBar

## PrÃ©-requisitos

- React Router configurado âœ…
- VinylVisualizer funcional âœ…
- useAudioStream hook funcional âœ…

## ReferÃªncias

- [RelatÃ³rio de Auditoria](../../audit-report-2025-12-03.md) - SeÃ§Ã£o 8: Performance
- [Vite Code Splitting](https://vitejs.dev/guide/build.html#chunking-strategy)
- [React Lazy Loading](https://react.dev/reference/react/lazy)

---

## Tasks/Subtasks

- [ ] Task 1: Criar Layout compartilhado com PlayerBar
  - [ ] Criar componente Layout.tsx (Header + Outlet + PlayerBar)
  - [ ] Criar componente PlayerBar.tsx (controles compactos)
  - [ ] Mover lÃ³gica de Ã¡udio (useAudioStream, useStreamingControl) para o Layout
  - [ ] Passar analyser via context ou props para VinylVisualizer

- [ ] Task 2: Refatorar pÃ¡gina inicial (minimalista)
  - [ ] Remover cards de features (ALSA, Icecast, Eventos, HistÃ³rico)
  - [ ] Remover seÃ§Ã£o Stack TecnolÃ³gico
  - [ ] Remover status cards (Backend/Frontend/Build)
  - [ ] Centralizar VinylVisualizer como protagonista
  - [ ] Adicionar tÃ­tulo "Live Vinyl Visualizer" e badge "ON AIR"

- [ ] Task 3: Implementar lazy loading de rotas
  - [ ] Converter imports de pÃ¡ginas secundÃ¡rias para React.lazy
  - [ ] Manter pÃ¡gina inicial (Home) com import estÃ¡tico
  - [ ] Adicionar Suspense com fallback (PageLoader)
  - [ ] Testar carregamento de cada rota

- [ ] Task 4: Otimizar chunks do Vite
  - [ ] Configurar manualChunks no vite.config.ts
  - [ ] Separar vendor chunks (react, socket.io, recharts)
  - [ ] Instalar e configurar rollup-plugin-visualizer
  - [ ] Analisar bundle e ajustar chunks

- [ ] Task 5: Configurar cache headers no backend
  - [ ] Criar middleware static-cache.ts
  - [ ] Cache-Control imutÃ¡vel para assets com hash
  - [ ] Cache moderado para outros assets
  - [ ] Integrar no index.ts

- [ ] Task 6: Validar e testar
  - [ ] Verificar player continua tocando entre pÃ¡ginas
  - [ ] Medir tamanho do bundle inicial (meta: < 100KB gzip)
  - [ ] Testar lazy loading das rotas
  - [ ] Verificar cache headers funcionando

---

## Design de UI

### Layout Geral (todas as pÃ¡ginas)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸµ Vinyl-OS  v1.0       [Dashboard] [SessÃµes] [Diag] [Config]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”‚                     < ConteÃºdo da PÃ¡gina >                      â”‚
â”‚                        (muda por rota)                          â”‚
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¶   Backend: â— Ativo      â–â–‚â–ƒâ–…â–†â–‡â–…â–ƒâ–‚   ğŸ”Šâ”â”â”â”â—â”â”â”  52ms   âš™ï¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚         â”‚                â”‚            â”‚        â”‚      â”‚
    Play   Status FFmpeg    VU Meter     Volume   LatÃªncia  Config
```

### PÃ¡gina Inicial (minimalista)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸµ Vinyl-OS  v1.0       [Dashboard] [SessÃµes] [Diag] [Config]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚                                                                 â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                     â”‚    â•­â”€â”€â”€â”€â”€â”€â”€â•®    â”‚                         â”‚
â”‚                     â”‚   â•± â•­â”€â”€â”€â•®   â•²   â”‚                         â”‚
â”‚                     â”‚  â”‚  â”‚ â— â”‚  â—‹ â”‚  â”‚   â† vinil girando       â”‚
â”‚                     â”‚   â•² â•°â”€â”€â”€â•¯   â•±   â”‚     com waveform        â”‚
â”‚                     â”‚    â•°â”€â”€â”€â”€â”€â”€â”€â•¯    â”‚                         â”‚
â”‚                     â”‚   â–â–‚â–ƒâ–…â–†â–‡â–…â–ƒâ–‚â–    â”‚   â† barras de freq      â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                 â”‚
â”‚                    ğŸ“» Live Vinyl Visualizer                     â”‚
â”‚                         â— ON AIR                                â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¶   Backend: â— Ativo      â–â–‚â–ƒâ–…â–†â–‡â–…â–ƒâ–‚   ğŸ”Šâ”â”â”â”â—â”â”â”  52ms   âš™ï¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PlayerBar - Estados

```
Backend parado:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â¸ï¸    Backend: â—‹ Parado  [Iniciar]         ğŸ”Šâ”â”â”â—â”â”â”      âš™ï¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Backend ativo, player pausado:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â–¶ï¸    Backend: â— Ativo                     ğŸ”Šâ”â”â”â—â”â”â”   --ms âš™ï¸  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tudo ativo (tocando):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â¸ï¸    Backend: â— Ativo   â–â–‚â–ƒâ–…â–†â–‡â–…â–ƒâ–‚â–       ğŸ”Šâ”â”â”â—â”â”â”   52ms âš™ï¸  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Erro:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â–¶ï¸    Backend: âš ï¸ Erro   [Tentar novamente] ğŸ”Šâ”â”â”â—â”â”â”      âš™ï¸   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ImplementaÃ§Ã£o Sugerida

### Layout.tsx (novo)

```typescript
// frontend/src/components/Layout/Layout.tsx
import { Outlet } from 'react-router-dom';
import { Header } from './Header';
import { PlayerBar } from './PlayerBar';
import { useAudioStream } from '@/hooks/useAudioStream';
import { useStreamingControl } from '@/hooks/useStreamingControl';

export function Layout() {
  const audioState = useAudioStream({ ... });
  const streamingControl = useStreamingControl();

  return (
    <div className="min-h-screen flex flex-col">
      <Header />
      <main className="flex-1">
        <Outlet context={{ analyser: audioState.state.analyser, isPlaying: audioState.playing }} />
      </main>
      <PlayerBar
        audioState={audioState}
        streamingControl={streamingControl}
      />
    </div>
  );
}
```

### PlayerBar.tsx (novo)

```typescript
// frontend/src/components/Layout/PlayerBar.tsx
export function PlayerBar({ audioState, streamingControl }) {
  const { playing, volume, togglePlayPause, setVolume, latency } = audioState;
  const { isStreaming, startStreaming, stopStreaming, isLoading } = streamingControl;

  return (
    <div className="fixed bottom-0 left-0 right-0 h-14 bg-card border-t flex items-center px-4 gap-4">
      {/* Play/Pause */}
      <Button onClick={togglePlayPause} size="icon" variant="ghost">
        {playing ? <Pause /> : <Play />}
      </Button>

      {/* Backend Status */}
      <div className="flex items-center gap-2">
        <span className="text-sm">Backend:</span>
        <Badge variant={isStreaming ? 'default' : 'secondary'}>
          {isStreaming ? 'â— Ativo' : 'â—‹ Parado'}
        </Badge>
        {!isStreaming && (
          <Button size="sm" onClick={startStreaming} disabled={isLoading}>
            Iniciar
          </Button>
        )}
      </div>

      {/* VU Meter (mini) */}
      <div className="flex-1 flex justify-center">
        <MiniVuMeter analyser={audioState.state.analyser} />
      </div>

      {/* Volume */}
      <div className="flex items-center gap-2 w-32">
        <Volume2 className="w-4 h-4" />
        <Slider value={[volume * 100]} onValueChange={([v]) => setVolume(v / 100)} />
      </div>

      {/* Latency */}
      <Badge variant="outline">{latency.toFixed(0)}ms</Badge>

      {/* Settings Link */}
      <Link to="/settings">
        <Settings className="w-4 h-4" />
      </Link>
    </div>
  );
}
```

### main.tsx (atualizado)

**ESTRATÃ‰GIA:** Nova UI disponÃ­vel em `/test` para validaÃ§Ã£o. UI atual em `/` permanece intacta.

```typescript
// frontend/src/main.tsx
import { lazy, Suspense, StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import { ThemeProvider } from './components/theme-provider';
import { ErrorBoundary } from './components/ErrorBoundary';

// UI ATUAL (mantida intacta)
import App from './App';
import Dashboard from './pages/Dashboard';
import Diagnostics from './pages/Diagnostics';
import Sessions from './pages/Sessions';
import SessionDetail from './pages/SessionDetail';
import Settings from './pages/Settings';

// NOVA UI (para teste em /test)
import { Layout } from './components/Layout/Layout';
import { PageLoader } from './components/PageLoader';
import Home from './pages/Home';

// Lazy load das pÃ¡ginas na nova UI
const LazyDashboard = lazy(() => import('./pages/Dashboard'));
const LazySessions = lazy(() => import('./pages/Sessions'));
const LazySessionDetail = lazy(() => import('./pages/SessionDetail'));
const LazySettings = lazy(() => import('./pages/Settings'));
const LazyDiagnostics = lazy(() => import('./pages/Diagnostics'));

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <ErrorBoundary>
      <ThemeProvider defaultTheme="dark" storageKey="vinyl-os-theme">
        <BrowserRouter>
          <Routes>
            {/* ========== UI ATUAL (inalterada) ========== */}
            <Route path="/" element={<App />} />
            <Route path="/dashboard" element={<Dashboard />} />
            <Route path="/diagnostics" element={<Diagnostics />} />
            <Route path="/sessions" element={<Sessions />} />
            <Route path="/sessions/:id" element={<SessionDetail />} />
            <Route path="/settings" element={<Settings />} />

            {/* ========== NOVA UI (teste em /test) ========== */}
            <Route path="/test" element={<Layout />}>
              <Route index element={<Home />} />
              <Route path="dashboard" element={
                <Suspense fallback={<PageLoader />}><LazyDashboard /></Suspense>
              } />
              <Route path="sessions" element={
                <Suspense fallback={<PageLoader />}><LazySessions /></Suspense>
              } />
              <Route path="sessions/:id" element={
                <Suspense fallback={<PageLoader />}><LazySessionDetail /></Suspense>
              } />
              <Route path="settings" element={
                <Suspense fallback={<PageLoader />}><LazySettings /></Suspense>
              } />
              <Route path="diagnostics" element={
                <Suspense fallback={<PageLoader />}><LazyDiagnostics /></Suspense>
              } />
            </Route>
          </Routes>
        </BrowserRouter>
      </ThemeProvider>
    </ErrorBoundary>
  </StrictMode>
);
```

**Acesso:**
- `http://localhost:5173/` â†’ UI atual (inalterada)
- `http://localhost:5173/test` â†’ Nova UI com Layout + PlayerBar

**ApÃ³s aprovaÃ§Ã£o:** Trocar rotas e remover UI antiga.

### Home.tsx (pÃ¡gina inicial refatorada)

```typescript
// frontend/src/pages/Home.tsx
import { useOutletContext } from 'react-router-dom';
import { VinylVisualizer } from '@/components/VinylVisualizer/VinylVisualizer';
import { Badge } from '@/components/ui/badge';

export default function Home() {
  const { analyser, isPlaying } = useOutletContext();

  return (
    <div className="flex flex-col items-center justify-center min-h-[calc(100vh-8rem)] p-4">
      {/* Vinil centralizado */}
      <VinylVisualizer analyser={analyser} isPlaying={isPlaying} />

      {/* TÃ­tulo e status */}
      <div className="mt-6 text-center">
        <h1 className="text-2xl font-bold flex items-center gap-2 justify-center">
          ğŸ“» Live Vinyl Visualizer
        </h1>
        <Badge
          variant={isPlaying ? 'default' : 'secondary'}
          className="mt-2"
        >
          {isPlaying ? 'â— ON AIR' : 'â—‹ Offline'}
        </Badge>
      </div>
    </div>
  );
}
```

### vite.config.ts (atualizado)

```typescript
// frontend/vite.config.ts
import path from "path";
import tailwindcss from "@tailwindcss/vite";
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { visualizer } from 'rollup-plugin-visualizer';

export default defineConfig({
  plugins: [
    react(),
    tailwindcss(),
    visualizer({ open: false, filename: 'bundle-analysis.html' })
  ],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'vendor-react': ['react', 'react-dom', 'react-router-dom'],
          'vendor-socket': ['socket.io-client'],
          'vendor-charts': ['recharts'],
          'vendor-ui': [
            '@radix-ui/react-dropdown-menu',
            '@radix-ui/react-select',
            '@radix-ui/react-slider',
            '@radix-ui/react-switch'
          ]
        }
      }
    },
    chunkSizeWarningLimit: 500
  },
  server: {
    proxy: { ... }
  }
});
```

### static-cache.ts (middleware backend)

```typescript
// backend/src/middleware/static-cache.ts
import { Request, Response, NextFunction } from 'express';

export function staticCache(maxAge: number = 86400) {
  return (req: Request, res: Response, next: NextFunction) => {
    // Cache imutÃ¡vel para assets com hash (ex: main.a1b2c3d4.js)
    if (req.path.match(/\.[a-f0-9]{8}\.(js|css|woff2?)$/)) {
      res.setHeader('Cache-Control', 'public, max-age=31536000, immutable');
    }
    // Cache moderado para outros assets estÃ¡ticos
    else if (req.path.match(/\.(js|css|png|jpg|jpeg|svg|ico|woff|woff2)$/)) {
      res.setHeader('Cache-Control', `public, max-age=${maxAge}`);
    }
    next();
  };
}
```

---

## Dev Agent Record

### Context Reference
- Story Context: (a ser criado quando ready-for-dev)

### Debug Log
- (a ser preenchido durante implementaÃ§Ã£o)

### Completion Notes
- (a ser preenchido apÃ³s conclusÃ£o)

---

## File List

### Arquivos a Criar
- frontend/src/components/Layout/Layout.tsx
- frontend/src/components/Layout/Header.tsx
- frontend/src/components/Layout/PlayerBar.tsx
- frontend/src/components/Layout/MiniVuMeter.tsx
- frontend/src/components/PageLoader.tsx
- frontend/src/pages/Home.tsx
- backend/src/middleware/static-cache.ts

### Arquivos a Modificar
- frontend/src/main.tsx (rotas com Layout e lazy loading)
- frontend/src/vite.config.ts (manualChunks + visualizer)
- frontend/package.json (rollup-plugin-visualizer)
- backend/src/index.ts (static-cache middleware)

### Arquivos a Remover/Deprecar
- frontend/src/App.tsx (conteÃºdo move para Home.tsx, arquivo pode ser removido)

---

## Change Log

- 2025-12-04: Story criada a partir do relatÃ³rio de auditoria
- 2025-12-04: Expandido escopo para incluir Layout persistente com PlayerBar e UI minimalista
